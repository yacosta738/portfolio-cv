---
import KeyboardManager from "@/components/KeyboardManager.astro";
import About from "@/components/sections/About.astro";
import Awards from "@/components/sections/Awards.astro";
import Certificates from "@/components/sections/Certificates.astro";
import Education from "@/components/sections/Education.astro";
import Experience from "@/components/sections/Experience.astro";
import Hero from "@/components/sections/Hero.astro";
import Interests from "@/components/sections/Interests.astro";
import Languages from "@/components/sections/Languages.astro";
import Projects from "@/components/sections/Projects.astro";
import Publications from "@/components/sections/Publications.astro";
import References from "@/components/sections/References.astro";
import Skills from "@/components/sections/Skills.astro";
import Volunteer from "@/components/sections/Volunteer.astro";
import { type Lang, LOCALES, useTranslations } from "@/i18n";
import Layout from "@/layouts/Layout.astro";
import { getMainResumeWithData } from "@/resume/resume/resume.service";

export const getStaticPaths = () =>
	Object.keys(LOCALES).map((lang) => ({
		params: { lang },
	}));

const currentLocale = Astro.params.lang as Lang;
const resume = await getMainResumeWithData({ lang: currentLocale });
if (!resume) {
	throw new Error("No se pudo obtener el resume principal");
}

const { name, label } = resume.basics;
const t = useTranslations(currentLocale);
const title = t("title", { name, label });
---

<Layout title={title}>
  <main id="main-content" class="px-16 py-16 mx-auto w-full sm:px-8">
    <Hero basics={resume.basics} />
    <About basics={resume.basics} />
    <Experience work={resume.work} />
    <Education education={resume.education} />

    {
      resume.projects && resume.projects.length > 0 && (
        <Projects projects={resume.projects} />
      )
    }

    {
      resume.skills && resume.skills.length > 0 && (
        <Skills skills={resume.skills} />
      )
    }

    {
      resume.awards && resume.awards.length > 0 && (
        <Awards awards={resume.awards} />
      )
    }

    {
      resume.certificates && resume.certificates.length > 0 && (
        <Certificates certificates={resume.certificates} />
      )
    }

    {
      resume.publications && resume.publications.length > 0 && (
        <Publications publications={resume.publications} />
      )
    }

    {
      resume.volunteer && resume.volunteer.length > 0 && (
        <Volunteer volunteer={resume.volunteer} />
      )
    }

    {
      resume.references && resume.references.length > 0 && (
        <References references={resume.references} />
      )
    }

    {
      resume.interests && resume.interests.length > 0 && (
        <Interests interests={resume.interests} />
      )
    }

    {
      resume.languages && resume.languages.length > 0 && (
        <Languages languages={resume.languages} />
      )
    }
  </main>

  <KeyboardManager />
</Layout>


