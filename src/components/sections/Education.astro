---
import Section from "@atoms/Section.astro";
import { type Lang, useTranslations } from "@/i18n";
import type Education from "@/resume/education/education.model";

// Props interface
interface Props {
	education: Education[];
}

const { education } = Astro.props as Props;
const currentLocale = Astro.params.lang as Lang;
const t = useTranslations(currentLocale);

// Helper: format month + year according to current locale (short month)
const formatDateWithMonth = (date: Date, locale: Lang): string => {
	const options: Intl.DateTimeFormatOptions = {
		year: "numeric",
		month: "short",
	};
	return date.toLocaleDateString(locale === "es" ? "es-ES" : "en-US", options);
};
---

<Section title={t('education')}>
  <ul class="flex flex-col gap-8">
    {
      education.map(({ institution, startDate, endDate, area }) => {
        const startFormatted = formatDateWithMonth(startDate, currentLocale);
        const endFormatted = endDate ? formatDateWithMonth(endDate, currentLocale) : null;
        const startIso = startDate.toISOString().split('T')[0];
        const endIso = endDate ? endDate.toISOString().split('T')[0] : null;

        return (
          <li>
            <article>
              <header class="flex justify-between items-start mb-1">
                <div>
                  <h3 class="font-medium text-foreground dark:text-foreground-inverted">{institution}</h3>
                </div>
                <div class="sm:text-right">
                  <time datetime={startIso} class="text-foreground-muted text-sm tabular-nums whitespace-nowrap" title={startIso}>{startFormatted}</time>
                  <span aria-hidden="true" class="mx-1">â€“</span>
                  <span class="sr-only">{t('range.to')}</span>
                  {endDate ? (
                    <time datetime={endIso} class="text-foreground-muted text-sm tabular-nums whitespace-nowrap" title={endIso}>{endFormatted}</time>
                  ) : (
                    <span class="text-foreground-muted text-sm tabular-nums whitespace-nowrap">{t('present') ?? 'Present'}</span>
                  )}
                </div>
              </header>

              <footer>
                <p class="text-foreground text-sm">{area}</p>
              </footer>
            </article>
          </li>
        )
      })
    }
  </ul>
</Section>


